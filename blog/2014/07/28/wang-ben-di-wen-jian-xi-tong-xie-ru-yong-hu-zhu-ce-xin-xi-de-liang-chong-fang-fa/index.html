<hr />

<p>layout: post
title: &ldquo;往本地文件系统写入用户注册信息的两种方法&rdquo;
date: 2014-07-28 22:13
comments: true
categories:
&mdash;-往本地文件系统写入用户注册信息的两种方法
&ndash;(IBAction)userRegister:(id)sender{</p>

<p>NSString*userRecord = [NSString stringWithFormat:@“\n%@,%@,%@&ldquo;,</p>

<pre><code>               self.userName.text,

               self.password.text,

               self.email.text];
</code></pre>

<p>NSString *docDir = [NSSearchPathForDirectoriesInDomains,</p>

<pre><code>                            NSDocumentDirectory,

                            NSUserDomainMask,YES)objectAtIndex: 0
</code></pre>

<p>];</p>

<p>NSString *userFile = [docDir stringByAppendingPathComponent:@&ldquo;userDat a.csv”];
NSLog(@“%@“,userFile);</p>

<p>if(![[NSFileManager defaultManager]fileExistsAtPath:userFile]){</p>

<p>if([[NSFileManager defaultManager]createFileAtPath:userFile contents:ni l attributes:nil)</p>

<p>NSLog(@“YES”);
else{</p>

<p>NSLog(@&ldquo;NO&mdash;注册失败!”);</p>

<pre><code>             }
      }
</code></pre>

<p>NSFileHandle *fileHandle = [NSFileHandle fileHandleForUpdatingAtPath:us erFile];</p>

<p>[fileHandle seekToEndOfFile];</p>

<p> [fileHandle writeData:[userRecord dataUsingEncoding:NSUTF8StringEncoding]];</p>

<p>[fileHandle closeFile];</p>

<p>[self regSuccess]</p>

<p>self.userName.text = @“&#8221;;</p>

<p>self.password.text = @“&#8221;;
self.email.text = @“&#8221;;
}
另外,还有一个辅助的方法 regSuccess,用来在屏幕上弹出用户注册成功的提示信息:
&ndash;(void)regSuccess{
  UIAlertView <em>alertDialog;
  alertDialog = [[UIAlertView alloc]initWithTitle:@&ldquo;EntLib.com 电子图书管理系统&rdquo;       message:@&ldquo;注册成功!&rdquo;
  delegate:self
  cancelButtonTitle:@&ldquo;OK&rdquo;
  otherButtonTitles:nil];
  [alertDialog show];}
接下来,是一个 NSFileHandle 类的 fileHandleForUpdatingAtPath 方法,获取指定该文件的引用,更新该文件。跳到文件的末尾,调用 writeData 方法,将用户注册信息写入到文件中。NSFileHandle </em>fileHandle =[NSFileHandle fileHandleForUpdatingAtPath:us erFile];[fileHandle seekToEndOfFile];
[fileHandle writeData:[userRecord dataUsingEncoding:NSUTF8StringEncoding];[fileHandle closeFile];在文件写入完毕之后,调用 closeFile 方法关闭文件手柄。</p>
